# 反弹相关的运动学模型

## 基本反弹模型

当一个小球与边界发生弹性碰撞时，其法向速度反向，切向速度不变，即：

$$
\vec{v}_0 = \vec{v}_{-1} - (1 + e)(\vec{v}_{-1} \cdot \vec{n}) \vec{n}
$$

其中：

- $\vec{v}_{-1}$​：碰撞前的速度向量
- $\vec{v}_{0}$ ：碰撞后的速度向量
- $\vec{n}$：碰撞点处边界的**单位外法向量**
- $e$​：**恢复系数**，表示法向速度的保持比例

## 抛体运动方程

仅考虑重力，小球抛体运动方程为：

$$
\vec{p}(t) =\vec{p}_0 + \vec{v}_0 t + \frac{1}{2} \vec{a} t^2
$$

结合碰撞方程，可得：

$$
\begin{align}
\vec{p}(t) 
&= \vec{p}_0 +( \vec{v}_{-1} + k\vec{n}) t + \frac{1}{2} \vec{a} t^2 \\
&= \vec{r}(t) + kt\vec{n}
\end{align}
$$

其中：

- $\vec{p}(t)$：某一时刻的位置
-  $\vec{p}_{0}$​ ：运动的初始位置
- $\vec{a}$：仅考虑常数的情形

## 计算恢复系数

给定终端时间 $t = t_f$ ，调整恢复系数，令此时小球恰好在边界圆周上，即：

$$
\left\| \vec{p}_f \right\|^2 = R^2
$$

于是有：

$$
\left\| \vec{p}_f \right\|^2 = \left\| \vec{r}_f \right\|^2 + 2kt_f (\vec{r}_f\cdot\vec{n}) + k^2t_f^2 = R^2
$$

整理为一元二次方程：

$$
A k^2 + B k + C = 0
$$

其中：

- $A = t_f^2$
- $B = 2t_f (\vec{r}_f \cdot \vec{n})$
- $C = \|\vec{r}_f\|^2 - R^2$

求解一元二次方程得到 $k$ ，进而反推出期望恢复系数：

$$
e = \frac{-k}{\vec{v}_{-1} \cdot \vec{n}} - 1
$$